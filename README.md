# DeaLynx Chrome Extension (Frontend & Integration)

This directory contains the front-end Chrome Extension for the DeaLynx prospect intelligence workspace. The extension injects a right-hand panel that connects to a FastAPI backend, which in turn triggers a Make.com automation workflow for email generation.

## Current Capabilities

* Fixed right-hand workspace (now in a glassy dark theme) that can be collapsed or reopened.
* **Single-Button Analysis:** Captures the entire page and sends it to the FastAPI backend.
* **Automated Email Drafting:** Triggers a Make.com workflow to analyze the prospect and create a personalized email draft in your Gmail, all from a single click.
* **Report Layout:** Shows skeleton placeholders while waiting for the backend/AI response to render sections.
* **Chat Panel:** Streams prompts to a stubbed `/chat` endpoint and displays typing indicators.

## Project Structure
You are 100% right. That single line of text is very hard to read.

The problem is that you are not using a code block. In Markdown, any text that isn't in a code block will have its newlines and extra spaces "collapsed" into a single, uneven line.

To fix this, you need to wrap your file structure in triple backticks (```). This tells GitHub to render the text exactly as you typed it, preserving all the newlines and spacing.

Here is the corrected code. Just copy and paste this into your README.md to replace the old "Project Structure" section.

Markdown

## Project Structure
```
chrome-extension/ 
├── background.js # Handles toolbar action clicks to toggle the sidebar 
├── contentScript.js # Injects the sidebar, manages session state, orchestrates API calls 
├── contentStyles.css # Dark theme styling, loaders, skeletons, capture overlay 
├── manifest.json # Chrome extension manifest (MV3) └── README.md # This file
```

## Installing the Extension Locally

1.  Open Google Chrome and navigate to `chrome://extensions`.
2.  Enable **Developer mode** (toggle in the top-right corner).
3.  Click **Load unpacked** and select the `chrome-extension` directory from this repository.
4.  Pin the DeaLynx extension to your toolbar for quick access.
5.  Open any web page (LinkedIn profiles are a good starting point) and click the extension icon. The right-hand workspace should slide in automatically.

## Using the Workspace

1.  Click **Analyse**. The extension will capture the page content and send it to the backend (`http://localhost:8000/api/sessions/{id}/analyze`).
2.  The panel shows a loader while it requests the report. When the backend replies, the report sections will animate in.
3.  **Check your Gmail "Drafts" folder.** Simultaneously, a personalized email, generated by the AI and processed by our Make.com automation, will be ready for your review.
4.  Use the **Chat** input to send prompts to `/sessions/{id}/chat`.

## Backend and Automation Workflow

This project's "backend" is a hybrid of a FastAPI server (for AI processing) and a Make.com automation (for email delivery).

All network calls are centralized at the top of `contentScript.js`. The `API_BASE_URL` constant should point to your live FastAPI deployment (e.g., on Render).

The end-to-end flow works like this:

1.  **Chrome Extension:** The user clicks "Analyse." The `contentScript.js` sends the scraped page content (URL, text, etc.) to the FastAPI backend.
2.  **FastAPI (Backend):** The backend receives the raw data. It then calls the **Google Gemini AI** agent with a specific prompt, instructing it to analyze the prospect and return a structured JSON object containing a `subject` and `body`.
3.  **Make.com (Automation Layer):** The FastAPI backend takes this JSON and immediately sends it as a payload to a secure **Make.com Webhook**.
4.  **Email Generation (Gmail):** The Make.com scenario (which we have built) triggers:
    * It receives the payload.
    * A **Text parser** module cleans the AI's output.
    * A **JSON** module parses the clean text.
    * A **Gmail** module maps the `subject` and `body` fields to a new draft email in your connected account.

This entire pipeline allows the user to get a fully drafted, personalized email ready for review in seconds, just by clicking one button.

## Next Integration Steps

* Connect the live FastAPI `/analyze` endpoint to the Make.com webhook URL to complete the automated email drafting flow.
* Persist session/capture identifiers so the backend can resume in-progress work.
* Replace the offline chat generator with the real conversational agent.
